/* @flow */

const path = require('path');
const merge = require('webpack-merge');
const needle = require('@knit/needle');
const webpackConfig = require('@knit/webpack-config-socks');

module.exports = merge(
  webpackConfig,
  {
    target: 'web',
    devtool: '#source-map',
    entry: {
      bundle: [path.join(needle.paths.entry, 'index.js')],
    },
    output: {
      path: path.join(needle.paths.dist, (typeof needle.env.__BASE__ === 'string' ? needle.env.__BASE__ : ''), 'js'),
      pathInfo: true,
      publicPath: path.join('/', (typeof needle.env.__BASE__ === 'string' ? needle.env.__BASE__ : ''), 'js/'),
      filename: 'bundle.js',
    },
  }
);
