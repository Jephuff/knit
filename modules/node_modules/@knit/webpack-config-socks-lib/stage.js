/* @flow */

const merge = require('webpack-merge');
const webpackConfig = require('@knit/webpack-config-socks-plain');
const needle = require('@knit/needle');

module.exports = merge(
  webpackConfig,
  {
    output: {
      libraryTarget: 'umd',
    },
    externals: Object.keys(needle.pkg.peerDependencies || {}),
    module: {
      loaders: ((webpackConfig.module || {}).loaders || []).map(l => {
        delete l.include; //eslint-disable-line
        return l;
      }),
    },
  }
);
