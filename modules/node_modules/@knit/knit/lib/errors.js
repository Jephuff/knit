/* @flow weak */

const chalk = require('chalk');
const log = require('./log');

exports.catchErrors = (err) => {
  console.log();
  if (err.cmd) {
    log.error(chalk.white(err.cmd));
    if (err.stderr || err.stdout) {
      err.stderr && log.subtree((err.stderr || '').split('\n    at')[0]);
      err.stdout && log.subtree((err.stdout || '').split('\n    at')[0]);
    } else {
      const PrettyError = require('pretty-error');

      const pe = new PrettyError();
      console.log();
      console.log(pe.render(err));
    }
  } else {
    const PrettyError = require('pretty-error');

    const pe = new PrettyError();
    console.log();
    console.log(pe.render(err));
  }
};
