#!/usr/bin/env node

const Listr = require('listr');
const chalk = require('chalk');

const errors = require('../lib/errors');
const log = require('../lib/log');

module.exports = () => {
  new Listr([
    ...require('../tasks/modules'),
    ...require('../tasks/updated'),
  ]).run().then(ctx => {
    console.log();
    if (!((ctx || {}).updated || []).length) {
      log.info(chalk.white('no updated modules found'));
    } else {
      log.info(chalk.white(`found ${ctx.updated.length} updated modules`));
      console.log();
      ctx.updated.forEach(u => console.log(` -- ${u}`));
    }
  }).catch(errors.catchErrors);
};
