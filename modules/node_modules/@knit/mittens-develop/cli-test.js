/* @flow weak */

const jestConfig = require('@knit/jest-config-socks');
const jest = require('jest');

module.exports = (argv) => {
  argv._.splice(0, 2);
  const opts = ['--config', JSON.stringify(jestConfig), ...argv._];

  if (process.env.CI === true) {
    opts.push('--bail');
    opts.push('--coverage');
  }

  if (process.env.NODE_ENV == null) {
    process.env.NODE_ENV = 'test';
  }

  jest.run(opts);
};
